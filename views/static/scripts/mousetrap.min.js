(function(){function K(h,j,f){if(h.addEventListener){return h.addEventListener(j,f,!1)}h.attachEvent("on"+j,f)}function e(f){return"keypress"==f.type?String.fromCharCode(f.which):Q[f.which]?Q[f.which]:d[f.which]?d[f.which]:String.fromCharCode(f.which).toLowerCase()}function I(h){var h=h||{},j=!1,f;for(f in N){h[f]?j=!0:N[f]=0}j||(M=!1)}function c(q,o,p,n,r){var j,l,k=[],h=p.type;if(!O[q]){return[]}"keyup"==h&&G(q)&&(o=[q]);for(j=0;j<O[q].length;++j){if(l=O[q][j],!(l.seq&&N[l.seq]!=l.level)&&h==l.action&&("keypress"==h&&!p.metaKey&&!p.ctrlKey||o.sort().join(",")===l.modifiers.sort().join(","))){n&&l.combo==r&&O[q].splice(j,1),k.push(l)}}return k}function E(f,h){!1===f(h)&&(h.preventDefault&&h.preventDefault(),h.stopPropagation&&h.stopPropagation(),h.returnValue=!1,h.cancelBubble=!0)}function i(j){j.which="number"==typeof j.which?j.which:j.keyCode;var o=e(j);if(o){if("keyup"==j.type&&g==o){g=!1}else{var h=j.target||j.srcElement,n=h.tagName;if(!(-1<(" "+h.className+" ").indexOf(" mousetrap ")?0:"INPUT"==n||"SELECT"==n||"TEXTAREA"==n||h.contentEditable&&"true"==h.contentEditable)){h=[];j.shiftKey&&h.push("shift");j.altKey&&h.push("alt");j.ctrlKey&&h.push("ctrl");j.metaKey&&h.push("meta");for(var h=c(o,h,j),l={},k=!1,n=0;n<h.length;++n){h[n].seq?(k=!0,l[h[n].seq]=1,E(h[n].callback,j)):!k&&!M&&E(h[n].callback,j)}j.type==M&&!G(o)&&I(l)}}}}function G(f){return"shift"==f||"ctrl"==f||"alt"==f||"meta"==f}function b(h,k,f){if(!f){if(!L){L={};for(var j in Q){95<j&&112>j||Q.hasOwnProperty(j)&&(L[Q[j]]=j)}}f=L[h]?"keydown":"keypress"}"keypress"==f&&k.length&&(f="keydown");return f}function a(v,t,u,s,q){var v=v.replace(/\s+/g," "),p=v.split(" "),r,o,n=[];if(1<p.length){var l=v,k=u;N[l]=0;k||(k=b(p[0],[]));v=function(){M=k;++N[l];clearTimeout(J);J=setTimeout(I,1000)};u=function(f){E(t,f);"keyup"!==k&&(g=e(f));setTimeout(I,10)};for(s=0;s<p.length;++s){a(p[s],s<p.length-1?v:u,k,l,s)}}else{o="+"===v?["+"]:v.split("+");for(p=0;p<o.length;++p){r=o[p],H[r]&&(r=H[r]),u&&("keypress"!=u&&F[r])&&(r=F[r],n.push("shift")),G(r)&&n.push(r)}u=b(r,n,u);O[r]||(O[r]=[]);c(r,n,{type:u},!s,v);O[r][s?"unshift":"push"]({callback:t,modifiers:n,action:u,seq:s,level:q,combo:v})}}for(var Q={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},d={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},F={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},H={option:"alt",command:"meta","return":"enter",escape:"esc"},L,O={},P={},N={},J,g=!1,M=!1,R=1;20>R;++R){Q[111+R]="f"+R}for(R=0;9>=R;++R){Q[R+96]=R}K(document,"keypress",i);K(document,"keydown",i);K(document,"keyup",i);var m={bind:function(j,n,h){for(var l=j instanceof Array?j:[j],k=0;k<l.length;++k){a(l[k],n,h)}P[j+":"+h]=n;return this},unbind:function(f,h){P[f+":"+h]&&(delete P[f+":"+h],this.bind(f,function(){},h));return this},trigger:function(f,h){P[f+":"+h]();return this},reset:function(){O={};P={};return this}};window.Mousetrap=m;"function"==typeof define&&define.amd&&define("mousetrap",function(){return m})})();